# กระบวนการทำงานของระบบ AI Property Consultant

## 1. การประมวลผลการสนทนา

### 1.1 การรับคำถามจากผู้ใช้
1. ผู้ใช้ส่งคำถามผ่าน API endpoint `/api/chat`
2. ระบบตรวจสอบและจัดการ session
3. บันทึกคำถามลงในประวัติการสนทนา

### 1.2 การวิเคราะห์คำถาม
1. ตรวจสอบภาษาที่ใช้ (ไทย/อังกฤษ)
2. วิเคราะห์อารมณ์และความต้องการ
3. ระบุประเภทคำถามและข้อมูลที่ต้องการ

### 1.3 การค้นหาข้อมูล
1. แปลงคำถามเป็นเวกเตอร์
2. ค้นหาอสังหาริมทรัพย์ที่เกี่ยวข้อง
3. จัดอันดับผลลัพธ์ตามความเกี่ยวข้อง

### 1.4 การสร้างคำตอบ
1. เลือกรูปแบบการตอบตามสไตล์ที่กำหนด
2. สร้างข้อความตอบกลับที่เหมาะสม
3. เพิ่มข้อมูลอสังหาริมทรัพย์ที่เกี่ยวข้อง

## 2. การจัดการข้อมูล

### 2.1 การอัพโหลดข้อมูล
1. รับไฟล์ CSV หรือ Excel ผ่าน `/api/upload`
2. ตรวจสอบความถูกต้องของข้อมูล
3. แปลงข้อมูลเป็นรูปแบบที่เหมาะสม
4. บันทึกลงในฐานข้อมูล MongoDB

### 2.2 การจัดการฐานข้อมูล
1. จัดเก็บข้อมูลอสังหาริมทรัพย์
2. จัดการประวัติการสนทนา
3. บริหารข้อมูลผู้ใช้
4. สำรองและดูแลรักษาข้อมูล

## 3. การจัดการผู้ใช้

### 3.1 การลงทะเบียนและเข้าสู่ระบบ
1. รับข้อมูลผู้ใช้ผ่าน `/api/register`
2. ตรวจสอบความถูกต้อง
3. สร้างบัญชีผู้ใช้ใหม่
4. จัดการการเข้าสู่ระบบผ่าน `/api/login`

### 3.2 การจัดการเซสชัน
1. สร้าง session_id สำหรับผู้ใช้
2. ติดตามการใช้งานในแต่ละเซสชัน
3. จัดการประวัติการสนทนา
4. ดูแลความปลอดภัยของข้อมูล

## 4. การประมวลผลภาษา

### 4.1 การรองรับหลายภาษา
1. ตรวจสอบภาษาที่ใช้
2. แปลงข้อความตามความเหมาะสม
3. สร้างคำตอบในภาษาที่ต้องการ

### 4.2 การปรับแต่งรูปแบบการสนทนา
1. เลือกรูปแบบตามที่กำหนด (ทางการ/ทั่วไป/เป็นกันเอง/มืออาชีพ)
2. ปรับแต่งน้ำเสียงการตอบ
3. เพิ่มความเป็นกันเองตามความเหมาะสม

## 5. การวิเคราะห์และปรับปรุง

### 5.1 การวิเคราะห์การใช้งาน
1. ติดตามพฤติกรรมผู้ใช้
2. วิเคราะห์ประสิทธิภาพการตอบคำถาม
3. ระบุจุดที่ต้องปรับปรุง

### 5.2 การปรับปรุงระบบ
1. ปรับปรุงการค้นหาข้อมูล
2. พัฒนารูปแบบการตอบ
3. เพิ่มประสิทธิภาพการทำงาน

## 6. การรักษาความปลอดภัย

### 6.1 การป้องกันข้อมูล
1. เข้ารหัสข้อมูลสำคัญ
2. จำกัดการเข้าถึง API
3. ตรวจสอบความปลอดภัยอย่างสม่ำเสมอ

### 6.2 การสำรองข้อมูล
1. สำรองฐานข้อมูลอย่างสม่ำเสมอ
2. เก็บประวัติการเปลี่ยนแปลง
3. วางแผนการกู้คืนข้อมูล 