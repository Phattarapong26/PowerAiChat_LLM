# ไดอะแกรมการทำงาน

## ภาพรวม

ไดอะแกรมการทำงานแสดงถึงลำดับขั้นตอนและความสัมพันธ์ระหว่างส่วนต่างๆ ของระบบ AI Property Consultant เพื่อให้เข้าใจการทำงานของระบบได้อย่างชัดเจน

## ไดอะแกรมการทำงานหลัก

### 1. การลงทะเบียนและเข้าสู่ระบบ
```mermaid
graph TD
    A[ผู้ใช้] -->|เข้าสู่ระบบ| B{ตรวจสอบข้อมูล}
    B -->|ถูกต้อง| C[เข้าสู่ระบบสำเร็จ]
    B -->|ไม่ถูกต้อง| D[แสดงข้อความผิดพลาด]
    A -->|ลงทะเบียน| E[กรอกข้อมูล]
    E --> F{ตรวจสอบข้อมูล}
    F -->|ถูกต้อง| G[สร้างบัญชีผู้ใช้]
    F -->|ไม่ถูกต้อง| H[แสดงข้อความผิดพลาด]
```

### 2. การค้นหาอสังหาริมทรัพย์
```mermaid
graph TD
    A[ผู้ใช้] -->|ป้อนคำค้นหา| B[แปลงเป็นเวกเตอร์]
    B --> C[ค้นหาในฐานข้อมูลเวกเตอร์]
    C --> D[เรียงลำดับผลลัพธ์]
    D --> E[แสดงผลลัพธ์]
    E --> F{เลือกอสังหาริมทรัพย์}
    F -->|ต้องการข้อมูลเพิ่มเติม| G[เริ่มการสนทนา]
    F -->|ไม่ต้องการข้อมูลเพิ่มเติม| H[กลับไปค้นหาใหม่]
```

### 3. การสนทนากับ AI
```mermaid
graph TD
    A[ผู้ใช้] -->|ส่งข้อความ| B[วิเคราะห์ข้อความ]
    B --> C[ค้นหาข้อมูลที่เกี่ยวข้อง]
    C --> D[สร้างคำตอบ]
    D --> E[ปรับแต่งคำตอบ]
    E --> F[ส่งคำตอบกลับ]
    F --> G{ผู้ใช้พึงพอใจ}
    G -->|ใช่| H[จบการสนทนา]
    G -->|ไม่ใช่| I[ถามเพิ่มเติม]
```

### 4. การจัดการข้อมูล
```mermaid
graph TD
    A[ข้อมูลใหม่] --> B{ตรวจสอบความถูกต้อง}
    B -->|ถูกต้อง| C[เพิ่มลงฐานข้อมูล]
    B -->|ไม่ถูกต้อง| D[ปฏิเสธข้อมูล]
    C --> E[สร้างเวกเตอร์]
    E --> F[เพิ่มลงฐานข้อมูลเวกเตอร์]
    G[ข้อมูลเก่า] --> H{ตรวจสอบความจำเป็น}
    H -->|จำเป็น| I[อัปเดตข้อมูล]
    H -->|ไม่จำเป็น| J[ลบข้อมูล]
```

## ไดอะแกรมการทำงานย่อย

### 1. การวิเคราะห์ผู้ใช้
```mermaid
graph TD
    A[ข้อมูลผู้ใช้] --> B[วิเคราะห์ความต้องการ]
    B --> C[วิเคราะห์พฤติกรรม]
    C --> D[สร้างโปรไฟล์ผู้ใช้]
    D --> E[ปรับแต่งการตอบสนอง]
```

### 2. การจัดการเซสชัน
```mermaid
graph TD
    A[เริ่มเซสชัน] --> B[สร้างโทเคน]
    B --> C[บันทึกข้อมูลเซสชัน]
    C --> D{ตรวจสอบเซสชัน}
    D -->|ถูกต้อง| E[อนุญาตการเข้าถึง]
    D -->|ไม่ถูกต้อง| F[ยกเลิกเซสชัน]
```

### 3. การสำรองข้อมูล
```mermaid
graph TD
    A[กำหนดเวลาสำรอง] --> B[สำรองข้อมูล]
    B --> C[ตรวจสอบความสมบูรณ์]
    C -->|สมบูรณ์| D[บันทึกสำรองข้อมูล]
    C -->|ไม่สมบูรณ์| E[แจ้งเตือน]
    F[ต้องการกู้คืน] --> G[เลือกข้อมูลสำรอง]
    G --> H[กู้คืนข้อมูล]
    H --> I[ตรวจสอบความถูกต้อง]
```

## การประมวลผลแบบเรียลไทม์

### 1. การประมวลผลข้อความ
```mermaid
graph TD
    A[รับข้อความ] --> B[แยกคำ]
    B --> C[วิเคราะห์ความหมาย]
    C --> D[ค้นหาข้อมูลที่เกี่ยวข้อง]
    D --> E[สร้างคำตอบ]
    E --> F[ส่งคำตอบ]
```

### 2. การประมวลผลรูปภาพ
```mermaid
graph TD
    A[รับรูปภาพ] --> B[ประมวลผลภาพ]
    B --> C[แยกแยะวัตถุ]
    C --> D[วิเคราะห์คุณสมบัติ]
    D --> E[สร้างคำอธิบาย]
    E --> F[ส่งคำอธิบาย]
```

## การจัดการข้อผิดพลาด

### 1. การจัดการข้อผิดพลาดทั่วไป
```mermaid
graph TD
    A[เกิดข้อผิดพลาด] --> B{ตรวจสอบประเภท}
    B -->|ข้อผิดพลาดระบบ| C[บันทึกข้อผิดพลาด]
    B -->|ข้อผิดพลาดผู้ใช้| D[แจ้งเตือนผู้ใช้]
    C --> E[แจ้งเตือนผู้ดูแลระบบ]
    D --> F[แนะนำวิธีแก้ไข]
```

### 2. การกู้คืนระบบ
```mermaid
graph TD
    A[ตรวจพบปัญหา] --> B{ประเมินความรุนแรง}
    B -->|รุนแรง| C[หยุดการทำงาน]
    B -->|ไม่รุนแรง| D[ทำงานต่อ]
    C --> E[วิเคราะห์ปัญหา]
    E --> F[แก้ไขปัญหา]
    F --> G[เริ่มระบบใหม่]
``` 